<!doctype html>
<html>
<head>
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <link rel="stylesheet" href="styles.css">
    <script src='Court.js'></script>
    <script src='helper.js'></script>
    <meta charset="utf-8">
    <title>Final Project</title>
</head>

<body>
    <div id="left-container"></div>
    <div id="right-container">
        <div id="top">
        </div>
        <div id="bottom">
        </div>
    </div>
    <script>
        // Test d3 was loaded
        console.log(d3);

        var WIDTH = 505;
        var HEIGHT = 475;

        //Make the Court SVG
        var courtSVG = d3.select("#top")
            .append("svg")
            .attr("id", "courtSVG")
            .attr("width", WIDTH - 5)
            .attr("height", HEIGHT);
        // Adjust the size of the SVG to make the court and append g
        courtSVG.attr('width', o.width)
            .attr('viewBox', "0 0 " + o.courtWidth + " " + o.visibleCourtLength)
            .append('g')
            .attr('class', 'shot-chart-court')

        // Load the CSV
        d3.csv("../Resources/James Harden.csv").then(function(data, error) {
            if (error) {
                throw error;
            }
            data.forEach(function(d) {
                // Print out every line in csv to console
                // console.log(d);

                //Store the data
                d.distance = d.SHOT_DISTANCE;
                d.x = d.LOC_X;
                d.y = d.LOC_Y;
                d.made = d.SHOT_MADE_FLAG;
            });

            // Aggregate the data, aggregate data is how many x, y points to cluster together
            var aggregateSize = 7;
            var nested = getCombinedData(data, aggregateSize);

            // Add the shots to the SVG
            courtSVG.select(".shot-chart-court")
                .selectAll("shots")
                .data(nested)
                .enter()
                .append("circle")
                .attr("cx", function(d) {
                    return scaleShotsX(d.key[0], WIDTH);
                })
                .attr("cy", function(d) {
                    return scaleShotsY(d.key[1], HEIGHT);
                })
                .attr("r", .5)
                .style("fill", function(d) {
                    //console.log(d.value.shootingPercentage);
                    //console.log(fgScale(d.value.shootingPercentage));
                    return fgScale(d.value.shootingPercentage);
                })
                .style("opacity", .25)
                .on("mouseover", function(d) {
                    console.log(d.value.shootingPercentage)
                });
            // Draw the court
            drawCourt(courtSVG.select("g"));
        });
    </script>
</body>
</html>
